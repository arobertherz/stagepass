var Stagepass=(()=>{(function(){let g="stagepass_domain",y="stagepass",$=t=>t==="debug"||t.endsWith(".sp")||t==="localhost"||t.startsWith("localhost:"),w=new URLSearchParams(window.location.search),d=document.querySelector('script[src*="loader"]'),b=null,v=null;if(d&&d.src)try{let t=new URL(d.src);b=t.searchParams.get("modules"),v=t.searchParams.get("silent")}catch{let s=d.src.match(/[?&]modules(=([^&]*))?/);s&&(b=s[2]!==void 0?s[2]:""),d.src.match(/[?&]silent/)&&(v="")}function A(t,...s){var l;if(!localStorage.getItem(g))return;let c=new Date().toTimeString().split(" ")[0],i="";try{let p=(l=new Error().stack)==null?void 0:l.split(`
`);if(p){let h=p.find((r,u)=>u>2&&!r.includes("log"));if(h){let r=h.match(/:([0-9]+):/);r&&(i=`:${r[1]}`)}}}catch{}let o=`[\u{1F3AB} ${c}${i?" \u{1F4CD}"+i:""}]`;t==="error"?console.log(`%c${o}`,"color: red; font-weight: bold;",...s):console[t]?console[t](o,...s):console.log(o,t,...s)}let f=(...t)=>A("log",...t),T=(...t)=>A("warn",...t),P=(...t)=>A("error",...t);window.splog=f,window.spwarn=T,window.sperror=P;let k=t=>t?t.replace(/^https?:\/\//,"").replace(/\/$/,""):null,C=!1,n=localStorage.getItem(g);if(w.has(y)){let t=w.get(y);if(t==="off"||t==="0"||t==="false")localStorage.removeItem(g),n=null,f("\u{1F50C} Stagepass disconnected.");else if(t){let e=t==="debug"?"debug":k(t);e&&$(e)?(localStorage.setItem(g,e),n=e,f(e==="debug"?"\u{1F50D} Stagepass debug mode enabled.":`\u{1F50C} Stagepass connected to: ${e}`),C=!0):e&&T(`Invalid domain: ${e}. Only .sp domains are allowed.`)}w.delete(y);let s=w.toString();window.history.replaceState({},"",window.location.pathname+(s?`?${s}`:"")+window.location.hash)}n&&!$(n)&&(localStorage.removeItem(g),n=null),n&&!C&&n!=="debug"&&f(`\u{1F50C} Stagepass connected to: ${n}`);let j=!!n,S=!!n&&n!=="debug",E=S?k(n):null,U=S?Date.now():0,W=U,B=U,m=window.location.hostname,R=m==="localhost"||m==="127.0.0.1"||m.startsWith("localhost:")||m.startsWith("127.0.0.1:"),I=S||R,L=I?"local":m.endsWith(".webflow.io")?"staging":"production";!(n&&$(n))&&!w.has(y)&&(L==="production"||L==="staging"&&v!==null)&&(console.log=console.warn=console.error=console.info=console.debug=()=>{});let M=window.stagepass||{};M.vars=Object.freeze({isLocal:I,env:L,domain:E||m,timestamp:B,version:"1.1.0"}),window.stagepass=M,globalThis.stagepass=M;function x(t,s,e,c,i){document.querySelectorAll(`${t}:not([data-stagepass-processed])`).forEach(o=>{o.setAttribute("data-stagepass-processed","true");let l=o.getAttribute(s),p=o.getAttribute(e);if(!p)return;if(!l&&p&&S&&E)try{let a=new URL(p).pathname.split("/");l=a[a.length-1]||a[a.length-2]}catch{let a=p.match(/\/([^\/\?#]+)(?:\?|#|$)/);a&&(l=a[1])}let h=S&&l&&E?`https://${E}/${l.startsWith("/")?l.substring(1):l}?_cb=${W}`:p;if(!h)return;let r=document.createElement(c);c==="script"?(r.src=h,Array.from(o.attributes).forEach(u=>{let a=u;i.includes(a.name)||r.setAttribute(a.name,a.value)}),!o.hasAttribute("async")&&!o.hasAttribute("defer")&&r.setAttribute("defer","")):(r.rel="stylesheet",r.href=h,Array.from(o.attributes).forEach(u=>{let a=u;i.includes(a.name)||r.setAttribute(a.name,a.value)})),o.parentNode?(o.parentNode.insertBefore(r,o),o.remove()):P(`${c} injection failed: No parent node`)})}function H(){if(b===null)return;let t=b===""?["all"]:b.split(",").map(e=>e.trim()).filter(Boolean);if(t.length===0)return;let s=window.location.origin;if(d&&d.src)try{let e=new URL(d.src),c=e.pathname.split("/");c.pop(),s=`${e.origin}${c.join("/")}`}catch{s=d.src.replace(/\/[^\/\?]+(\?.*)?$/,"")}t.forEach(e=>{let c=`${s}/${e}.min.js`,i=document.createElement("script");i.src=c,i.async=!0,document.head.appendChild(i),L!=="production"&&f(`\u{1F4E6} Loading module: ${e}`)})}let D=()=>{x("script[data-stagepass]","data-stagepass-path","data-src","script",["data-src","data-stagepass","data-stagepass-path"]),x('link[rel="stylesheet"][data-stagepass]',"data-stagepass-path","data-href","link",["href","data-href","data-stagepass","data-stagepass-path"])};H(),D(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",D);function O(){if(!j)return;let t=document.createElement("div");t.id="stagepass-flag",t.textContent=n==="debug"?"STAGEPASS DEBUG":"STAGEPASS ACTIVE",t.style.cssText='font:12px/1 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;font-weight:bold;color:#fff;background:#D92662;padding:4px 6px;z-index:9999999999;position:fixed;top:0;right:0;cursor:pointer;border-radius:0 0 0 4px;user-select:none;',t.addEventListener("click",()=>{localStorage.removeItem(g),f("\u{1F50C} Stagepass disconnected."),window.location.reload()}),document.body?document.body.appendChild(t):document.addEventListener("DOMContentLoaded",()=>{document.body&&document.body.appendChild(t)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):O()})();})();
