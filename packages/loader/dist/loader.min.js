var Stagepass=(()=>{(function(){let m="stagepass_domain",v="stagepass",A=t=>t==="debug"||t.endsWith(".sp")||t==="localhost"||t.startsWith("localhost:"),b=new URLSearchParams(window.location.search),l=document.querySelector('script[src*="loader"]'),y=null,M=null;if(l&&l.src)try{let t=new URL(l.src);y=t.searchParams.get("modules"),M=t.searchParams.get("silent")}catch{let s=l.src.match(/[?&]modules(=([^&]*))?/);s&&(y=s[2]!==void 0?s[2]:""),l.src.match(/[?&]silent/)&&(M="")}function P(t,...s){var r;if(!localStorage.getItem(m))return;let d=new Date().toTimeString().split(" ")[0],n="";try{let u=(r=new Error().stack)==null?void 0:r.split(`
`);if(u){let w=u.find((i,g)=>g>2&&!i.includes("log"));if(w){let i=w.match(/:([0-9]+):/);i&&(n=`:${i[1]}`)}}}catch{}let e=`[\u{1F3AB} ${d}${n?" \u{1F4CD}"+n:""}]`;t==="error"?console.log(`%c${e}`,"color: red; font-weight: bold;",...s):console[t]?console[t](e,...s):console.log(e,t,...s)}let p=(...t)=>P("log",...t),k=(...t)=>P("warn",...t),T=(...t)=>P("error",...t);window.splog=p,window.spwarn=k,window.sperror=T;let x=t=>t?t.replace(/^https?:\/\//,"").replace(/\/$/,""):null,C=!1,a=localStorage.getItem(m);if(b.has(v)){let t=b.get(v);if(t==="off"||t==="0"||t==="false")localStorage.removeItem(m),a=null,p("\u{1F50C} Stagepass disconnected.");else if(t){let o=t==="debug"?"debug":x(t);o&&A(o)?(localStorage.setItem(m,o),a=o,p(o==="debug"?"\u{1F50D} Stagepass debug mode enabled.":`\u{1F50C} Stagepass connected to: ${o}`),C=!0):o&&k(`Invalid domain: ${o}. Only .sp domains are allowed.`)}b.delete(v);let s=b.toString();window.history.replaceState({},"",window.location.pathname+(s?`?${s}`:"")+window.location.hash)}a&&!A(a)&&(localStorage.removeItem(m),a=null),a&&!C&&a!=="debug"&&p(`\u{1F50C} Stagepass connected to: ${a}`);let R=!!a,S=!!a&&a!=="debug",E=S?x(a):null,I=S?Date.now():0,W=I,B=I,f=window.location.hostname,N=f==="localhost"||f==="127.0.0.1"||f.startsWith("localhost:")||f.startsWith("127.0.0.1:"),U=S||N,h=U?"local":f.endsWith(".webflow.io")?"staging":"production";!(a&&A(a))&&!b.has(v)&&(h==="production"||h==="staging"&&M!==null)&&(console.log=console.warn=console.error=console.info=console.debug=()=>{});let L=window.stagepass||{};L.vars=Object.freeze({isLocal:U,env:h,domain:E||f,timestamp:B,version:"1.1.0"});let $=null,H=null,V=new Promise((t,s)=>{$=t,H=s});L.ready=V,window.stagepass=L,globalThis.stagepass=L;function j(t,s,o,d,n){document.querySelectorAll(`${t}:not([data-stagepass-processed])`).forEach(e=>{e.setAttribute("data-stagepass-processed","true");let r=e.getAttribute(s),u=e.getAttribute(o);if(!u)return;if(!r&&u&&S&&E)try{let c=new URL(u).pathname.split("/");r=c[c.length-1]||c[c.length-2]}catch{let c=u.match(/\/([^\/\?#]+)(?:\?|#|$)/);c&&(r=c[1])}let w=S&&r&&E?`https://${E}/${r.startsWith("/")?r.substring(1):r}?_cb=${W}`:u;if(!w)return;let i=document.createElement(d);d==="script"?(i.src=w,Array.from(e.attributes).forEach(g=>{let c=g;n.includes(c.name)||i.setAttribute(c.name,c.value)}),!e.hasAttribute("async")&&!e.hasAttribute("defer")&&i.setAttribute("defer","")):(i.rel="stylesheet",i.href=w,Array.from(e.attributes).forEach(g=>{let c=g;n.includes(c.name)||i.setAttribute(c.name,c.value)})),e.parentNode?(e.parentNode.insertBefore(i,e),e.remove()):T(`${d} injection failed: No parent node`)})}function F(){if(y===null){$&&$();return}let t=y===""?["all"]:y.split(",").map(n=>n.trim()).filter(Boolean);if(t.length===0)return;let s=window.location.origin;if(l&&l.src)try{let n=new URL(l.src),e=n.pathname.split("/");e.pop(),s=`${n.origin}${e.join("/")}`}catch{s=l.src.replace(/\/[^\/\?]+(\?.*)?$/,"")}let o=0;function d(){if(o>=t.length){h!=="production"&&p("\u2705 All modules loaded"),$&&$();return}let n=t[o],e=`${s}/${n}.min.js`,r=document.createElement("script");r.onload=()=>{h!=="production"&&p(`\u{1F4E6} Module loaded: ${n}`),o++,d()},r.onerror=()=>{h!=="production"&&T(`Failed to load module: ${n}`),o++,d()},r.src=e,document.head.appendChild(r)}d()}let D=()=>{j("script[data-stagepass]","data-stagepass-path","data-src","script",["data-src","data-stagepass","data-stagepass-path"]),j('link[rel="stylesheet"][data-stagepass]',"data-stagepass-path","data-href","link",["href","data-href","data-stagepass","data-stagepass-path"])};F(),D(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",D);function O(){if(!R)return;let t=document.createElement("div");t.id="stagepass-flag",t.textContent=a==="debug"?"STAGEPASS DEBUG":"STAGEPASS ACTIVE",t.style.cssText='font:12px/1 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;font-weight:bold;color:#fff;background:#D92662;padding:4px 6px;z-index:9999999999;position:fixed;top:0;right:0;cursor:pointer;border-radius:0 0 0 4px;user-select:none;',t.addEventListener("click",()=>{localStorage.removeItem(m),p("\u{1F50C} Stagepass disconnected."),window.location.reload()}),document.body?document.body.appendChild(t):document.addEventListener("DOMContentLoaded",()=>{document.body&&document.body.appendChild(t)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):O()})();})();
